#!/bin/bash
set -e
eval "$($(dirname $0)/adr-config)"

## usage: adr init [DIRECTORY]
##
## Initialises the directory of architecture decision records:
##
##  * creates a subdirectory of the current working directory
##  * creates the first ADR in that subdirectory, recording the decision to
##    record architectural decisions with ADRs.
##
## If the DIRECTORY is not given, the ADRs are stored in the directory `doc/adr`.

if [ ! -z $1 ]; then
  mkdir -p "$1"
  echo "$1" >.adr-dir
  ADR_DIR="$1"
fi

template = "init-parables-boltnoel.md"
if [ ! -z "$2" ]; then
  template = "$2"
fi

ADR_TEMPLATE="$adr_template_dir/$template"

echo "$template"
echo "$ADR_TEMPLATE"

"$adr_bin_dir/adr-new" Record Architecture Decisions

# Copy additional template files into the initialized directory
cp "$ADR_TEMPLATE" "$ADR_DIR/templates/template.md"
cp "$adr_template_dir/template-parables-boltnoel.md" "$ADR_DIR/templates/template-parables-boltnoel.md"
cp "$adr_template_dir/template-full-parables-boltnoel.md" "$ADR_DIR/templates/template-full-parables-boltnoel.md"

echo "Initialized ADR directory at $ADR_DIR with selected template and additional files."
